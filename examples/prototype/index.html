<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />
        <title>EngineKernel åŸå‹éªŒè¯</title>
        <link rel="stylesheet" href="./index.css " />
        
        <!-- ä½¿ç”¨æœ¬åœ° THREE.js æ–‡ä»¶çš„ import map -->
        <script type="importmap">
        {
            "imports": {
                "three": "./libs/three.module.js",
                "three/examples/jsm/controls/OrbitControls.js": "./libs/OrbitControls.js",
                "three/examples/jsm/loaders/GLTFLoader.js": "./libs/GLTFLoader.js",
                "three/examples/jsm/renderers/CSS3DRenderer.js": "./libs/CSS3DRenderer.js",
                "three/examples/jsm/objects/Sky.js": "./libs/Sky.js"
            }
        }
        </script>
    </head>
    <body>
        <canvas id="container"></canvas>
        
        <script type="module">
            // ä½¿ç”¨æœ¬åœ° THREE.js æ–‡ä»¶
            import * as THREE from 'three';
            import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';
            import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';
            import { CSS3DRenderer, CSS3DObject } from 'three/examples/jsm/renderers/CSS3DRenderer.js';
            import { Sky } from 'three/examples/jsm/objects/Sky.js';
            
            // å°†æ¨¡å—æŒ‚è½½åˆ°å…¨å±€ï¼Œä»¥ä¾›æˆ‘ä»¬çš„ UMD åŒ…ä½¿ç”¨
            window.THREE = THREE;
            // ç”±äº THREE å¯¹è±¡ä¸å¯æ‰©å±•ï¼Œæˆ‘ä»¬ç›´æ¥æŒ‚è½½åˆ° window
            window.OrbitControls = OrbitControls;
            window.GLTFLoader = GLTFLoader;
            window.CSS3DRenderer = CSS3DRenderer;
            window.CSS3DObject = CSS3DObject;
            window.Sky = Sky;
            
            console.log('THREE.js æ¨¡å—å·²åŠ è½½:', THREE);
            console.log('OrbitControls å·²åŠ è½½:', OrbitControls);
            console.log('CSS3DRenderer å·²åŠ è½½:', CSS3DRenderer);
            console.log('CSS3DObject å·²åŠ è½½:', CSS3DObject);
            console.log('æ‰€æœ‰æ¨¡å—å·²ä»æœ¬åœ°æ–‡ä»¶åŠ è½½å®Œæˆ');
            
            // åŠ¨æ€åŠ è½½æˆ‘ä»¬çš„ EngineKernel
            const script = document.createElement('script');
            script.src = 'http://localhost:8080/engine-kernel.dev.js';
            script.onload = function() {
                // ç­‰å¾…ä¸€ä¸‹ï¼Œç¡®ä¿æ¨¡å—å®Œå…¨åŠ è½½
                setTimeout(() => {
                    if (typeof window.EngineKernel !== 'undefined' && window.EngineKernel.constructor !== Promise) {
                        console.log("ğŸš€ ~ EngineKernel åŠ è½½æˆåŠŸ:", window.EngineKernel);
                        loadMainScript();
                    } else if (window.EngineKernel && typeof window.EngineKernel.then === 'function') {
                        window.EngineKernel.then(engine => {
                            window.EngineKernel = engine;
                            console.log("ğŸš€ ~ EngineKernel å¼‚æ­¥åŠ è½½æˆåŠŸ:", window.EngineKernel);
                            loadMainScript();
                        });
                    } else {
                        console.error('EngineKernel æ¨¡å—åŠ è½½å¤±è´¥');
                    }
                }, 100);
            };
            script.onerror = function() {
                console.error('æ— æ³•åŠ è½½ EngineKernel è„šæœ¬');
            };
            document.head.appendChild(script);

            function loadMainScript() {
                // åŠ¨æ€åŠ è½½ä¸»è¦é€»è¾‘
                const mainScript = document.createElement('script');
                mainScript.src = './index.js';
                document.body.appendChild(mainScript);
            }
        </script>
    </body>
</html>
<!-- 

åç»­è®¡åˆ’

- [ ] è®©loadPluginã€unloadPluginã€æ–¹æ³•å‘æŒ¥ä½œç”¨

- [ ] å®‰æ’æ’ä»¶åŠ è½½ç­–ç•¥ï¼ˆææ¸…æ¥šæ˜¯æ³¨å†Œè¿˜æ˜¯åŠ è½½ï¼Œè¿™ä¸¤è€…çš„èŒè´£å’Œå…ˆåé¡ºåºææ¸…æ¥šï¼Œæ’ä»¶çš„åŠ è½½ç­–ç•¥æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ
åœ¨åŒæ­¥åŠ è½½çš„æ’ä»¶å’Œå¼‚æ­¥åŠ è½½çš„æ’ä»¶åŒæ—¶å­˜åœ¨çš„æƒ…å†µåº”è¯¥å¦‚ä½•å¤„ç†ï¼ŒåŠ è½½é¡ºåºã€åŠ è½½ç­–ç•¥ä¼šä¸ä¼šå½±å“ä¾èµ–å…³ç³»ï¼Ÿï¼‰

- [ ] æ’ä»¶çš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚æ§åˆ¶å™¨æ’ä»¶å°±ä¾èµ–äºæ¸²æŸ“å™¨æ’ä»¶æä¾›çš„domå’ŒåŸºç¡€åœºæ™¯æ’ä»¶baseSceneæä¾›çš„cameraï¼Œ
æ‰€ä»¥æ§åˆ¶å™¨æ’ä»¶åœ¨åŠ è½½/æ³¨å†Œä¹‹å‰å°±å¿…é¡»è¦æ‹¿åˆ°baseSceneå’Œæ¸²æŸ“å™¨æ’ä»¶çš„å®ä¾‹

- [ ] åç»­åŠŸèƒ½çš„æ·»åŠ ï¼ˆç‰¹æ•ˆæ¨¡å—ã€æ¥¼æ ‹åˆ†å±‚ã€ï¼‰

- [ ] é¼ æ ‡æ‹¾å–æš‚æ—¶ç”¨å…‰çº¿æ‹¾å–ã€åç»­æ·»åŠ GPUæ‹¾å–

- [ ] ææ¸…æ¥šç¬›å¡å°”åæ ‡ç³»åœ¨å…·ä½“ä¸­çš„åº”ç”¨

- [ ] å¯å¦å®ç°æ¶æ„ä¸æ’ä»¶ç›¸åˆ†ç¦»ï¼Ÿï¼ˆéœ€è¦ä¸€ä¸ªç¨³å®šçš„æ¶æ„ï¼Œç„¶åå®‰å¿ƒå¼€å‘æ’ä»¶å°±è¡Œäº†ï¼‰

- [ ] é™å®šäº‹ä»¶ç±»å‹ï¼ˆæ‰€æœ‰äº‹ä»¶ç±»å‹çš„æšä¸¾ï¼‰

- [ ] å¯ä»¥å°†äº‹ä»¶å‘å¸ƒè®¢é˜…æœºåˆ¶åŒ…è£…å¥½ç„¶åç”±coreæ ¸å¿ƒæ¨¡å—ç»§æ‰¿ï¼Œæ›´å¥½çš„å®ç°æ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸æ’ä»¶é€šä¿¡ç‰¹æ€§

- [ ] æ¢ç©¶è·¯å¾„è§„åˆ’æ–¹æ³•ï¼ˆåœºæ™¯ä¸­éšæœºé€‰å–çš„ä¸¤ç‚¹ä¹‹é—´çš„æœ€ä¼˜è·¯å¾„ï¼Œå¹¶ä¸”èƒ½å¤Ÿç»•è¿‡å¢™å£ã€é€šè¿‡æ¥¼æ¢¯ç”µæ¢¯ã€ï¼‰

- [ ] ç§‘æŠ€æ„Ÿåœ°æ¿ç‰¹æ•ˆ+å¤©ç©ºç›’ï¼ˆè´´å›¾æˆ–shaderï¼‰

- [ ] éœ€è¦ææ‡‚ï¼š

- [ ] htmlè½¬3Då¯¹è±¡ï¼šç›®å‰threejsç¤ºä¾‹ç»™å‡ºçš„ä¾‹å­ä¸å¥½

-->
